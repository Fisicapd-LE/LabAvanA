Per poter lavorare al meglio con l'apparato strumentale dato e comprendere al meglio il meccanismo di funzionamento si è deciso di scrivere un programma in grado di simulare
il processo che avviene durante le vere e proprie sessioni di misura. In questa sezione si vuole descrivere brevemente il funzionamento di tale programma di simulazione e
l'output che tale programma è in grado di fornire.
\subsection{Generazione dei raggi cosmici}
Come prima cosa è necessario il programma simuli dei raggi cosmici che siano realistici. Per fare questo si è utilizzata la nota distribuzione dei raggi cosmici:
% \begin{equation}
% \ref{eq:distr_cosmici}
% 
% !!!!!!!! inserire distribuzione raggi cosmici !!!!!!!!!!!!
% \end{equation}
per ogni evento un raggio cosmico viene generato in un punto casuale del piano lungo 700 mm lungo $x$ e 350 mm lungo $y$ in un certo punto di $z$ e la direzione di tale
raggio cosmico è data dall'Equazione \ref{eq:distr_cosmici}: in questo modo si ha un raggio cosmico che probabilmente è \textit{interessante} per l'apparato strumentale.
Tali raggi cosmici vengono fatti evolvere nel limite ultrarelativistico: data la loro alta velocità si può considerare che essi seguano una traiettoria rettilinea nonostante
le forze esterne (in particolare rilevante in aria è l'effetto del campo magnetico che tenderebbe a deviare la traiettoria), e si muovano a velocità infinita.

\subsection{Interazione con i rivelatori}
Quando viene fatto evolvere un muone esso potrebbe entrare all'interno dei rivelatori, che possono rivelare tale passaggio. Per modellizzare tale evento, come prima cosa,
si considera che il rivelatore non influenza il raggio cosmico (il muone non può quindi essere assorbito all'interno del rivelatore secondo questa modellizzazione), inoltre
si modellizza l'interazione come un fenomeno esattamente prevedibile e non stocastico come realmente è. Per poter comprendere cosa succede quando un muone attraversa
un rivelatore si utilizzano i dati sperimentali (otttenuti come descritto alla Sezione !!!!!!!INSERIRE RIFERIMENTO A SEZIONE!!!!!!!): data la moda della distribuzione
sperimentale di fotoni, quello si itnerpreta come il numero di fotoni generati dal passaggio di un muone cosmico quando attraversa lo spessore (noto) del rivelatore
in direzione perpendicolare alla faccia del rivelatore stesso. In questo modo si può andare a stimare effettivamente quanti fotoni vengono generati per ogni mm 
di scintillatore attraversato dal muone cosmico (si noti che si stanno trascurando parecchi fattori, come per esempio il diverso assorbimento in diversi punti dell'assorbitore
a diversa distanza dalla fibra ottica all'interno dello scintillatore). Così, usando delle identità trigonometriche, è stato possibile trovare lo spazio percorso
all'interno del rivelatore e, noto quest'ultimo, è stato possibile trovare il numero di fotoni che ci si aspettta arrivino ai canali di acquisizione.

\subsection{Interazione con l'assorbitore}
Per quanto riguarda l'interazione con l'assorbitore, diversamente a quanto fatto per l'interazione con i rivelatori, si considera il processo come stocastico. Un muone
ha una probabilità di interagire con il materiale che dipende dal materiale stesso e dall'energia del muone. Tale relazione è stata linearizzata, e si è considerato che il
muone ha probabilità di decadere uniforme in una regione spaziale ben definita\footnote{tale regione è stata impostata computazionalmente in modo che non si generino troppi
dati inutili, quindi a meno di un coefficiente moltiplicativo da determinare sperimentalmente una volta che l'apparato sarà operativo.}. Si è inoltre modellizzato il fenomeno
in modo tale che il muone possa \textit{solamente} fermarsi all'interno dell'assorbitore o non farlo, si stanno cioè trascurando i casi in cui il muone rallenta
all'interno dell'assorbitore prima di essere assorbito completamente (infatti fisicamente il muone tende a perdere gran parte della sua energia in un urto: se riesce
a fare un secondo urto con il materiale dell'assorbitore prima di decadere esso sarà comunque in una posizione molto vicina a quella del primo urti, quindi si può
considerare che esso abbia fatto effettivamente un solo urto).

\subsection{Implementazione del caampo magnetico}
Il campo magnetico dell'esperimento è generato da un solenoide finito a sezione rettangolare. Si è voluto andare ad utilizzare un campo che non fosse uniforme all'interno
del solenoide, e per farlo si è risolto numericamente tale problema. Si è introdotta la corrente come pareti di corrente uniforme e costante, si è discretizzato lo spazio
e si è utlizzato l'algoritmo di Jacobi per ottenere il potenziale vettore data la densità di corrente introdotta. Poi si è calcolato numericamente il rotore per
andare a trovare effettivamente il campo magnetico. L'algoritmo è stato fattto girare su uno spazio più grande (circa un fattore 4) del solenoide, in modo che siano
fisicamente sensate le condizioni al contorno assorbenti ai bordi del sistema. Da questo calcolo si è trovato come effettivamente il campo magnetico non sia costante
all'interno del solenoide ma abbia una dipendenza dalla posizione, come si può vedere nella Figura \ref{gr:campo_xy} dove si può vedere la proiezione lungo una
sezione del solenoide della componente del campo magnetico parallela all'asse del solenoide stesso. Questo processo di risoluzione numerica dell'equazione differenziale
ha permesso di avere dei valori per il campo magnetico più realistici che dipendano dalla posizione presa in considerazione.
\input{./graphs/campo_xy}

\subsection{Decadimento del muone cosmico}
Se il muone cosmico viene fermato all'interno dell'assorbitore, esso decadrà dopo un tempo che dipende dal tipo di muone che si ferma (muone o antimuone), che è distribuito
come un esponenziale dal tempo caratteristico che viene assunto come noto dalla letteratura. Perciò si considera il muone, fermo, trascorra un tempo che in media è il tempo
di vita di tale muone, e poi decada emettendo sostanzialmente un elettrone (non sono rilevabili gli altri prodotti del decadimento). \'E utile introdurre inoltre lo spin.
!!!!!ENRICO PARLA DI COME HAI TRATTATO LO SPIN!!!!!!!

\subsection{Implementazione dell'elettrone}
Una volta che il programma di simulazione genera un elettrone con la sua posizione e la sua direzione, taale elettrone viene fatto evolvere \" all'indietro \" rispetto a
come è stato fatto evolvere il muone inizialmente, e si considera se esso viene riassorbito all'interno dell'assorbitore e in quali scintillatori lascia segnali, e quanto
intensi sono tali segnali.

\subsection{Output della simulazione}
Gli output utili della simulazione descritta ai punti precedenti sono numerosi e interessanti:
\begin{intemize}
\item Efficienza: considerando solamente l'interazione tra i raggi cosmici e gli scintillatori è possibile stimare quanti muoni non risultano in coincidenza a causa
di condizioni geometriche non favorevoli, per esempio quelli che lasciano segnale attraversando ai bordi i due rivelatori superiori ma non entrano nemmeno nel terzo
rivelatore
\item Spettro temporale: data tutta la simulazione fatta, è possibile fare un plot del tempo che intercorre tra il passaggio del muone e quello dell'elettrone, riottenendo
l'esponenziale del tempo di decadimento
\item !!!!!!!Cos'era quel grafico figo?!!!!!!!!!!!!!!
\end{itemize}
